
| 特性           | 说明                                                         |
| -------------- | ------------------------------------------------------------ |
| 一次性         | Watcher是一次性的，一旦被触发就会移除，再次使用时需要重新注册 |
| 客户端顺序回调 | Watcher回调是顺序串行化执行的，只有回调后客户端才能看到最新的数据状态。一个Watcher回调逻辑不应该太多，以免影响别的watcher执行 |
| 轻量级         | WatchEvent是最小的通信单元，结构上只包含通知状态、事件类型和节点路径，并不会告诉数据节点变化前后的具体内容； |
| 时效性         | Watcher只有在当前session彻底失效时才会无效，若在session有效期内快速重连成功，则watcher依然存在，仍可接收到通知； |



**注**：客户端接收到的相关事件通知中只包含状态及类型等信息，不包括节点变化前后的具体内容，**变化前的数据需业务自身存储，变化后的数据需调用get等方法重新获取；**



## Watcher注册

![img](../图片/webp)


1. 客户端发送的请求中只包含是否需要注册Watcher，不会将Watcher实体发送；
2. Packet构造函数中的参数WatchRegistration是Watcher的封装体，用于服务响应成功后将Watcher保存到ZKWatchManager中；



## Watcher通知

![img](../图片/webp-20211127211428177)
